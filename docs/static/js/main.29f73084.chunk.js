(this["webpackJsonpreact-example"]=this["webpackJsonpreact-example"]||[]).push([[0],{31:function(e,t,a){e.exports=a.p+"static/media/wowza-logo.c9001ef3.svg"},32:function(e,t,a){e.exports=a.p+"static/media/file_copy-24px.af0d3034.svg"},34:function(e,t,a){e.exports=a.p+"static/media/mic-32px.e86ba651.svg"},35:function(e,t,a){e.exports=a.p+"static/media/mic-off-32px.725ec334.svg"},36:function(e,t,a){e.exports=a.p+"static/media/videocam-32px.fc4b7780.svg"},37:function(e,t,a){e.exports=a.p+"static/media/videocam-off-32px.342a0624.svg"},39:function(e,t,a){e.exports=a(67)},44:function(e,t,a){},61:function(e,t,a){},62:function(e,t,a){},65:function(e,t,a){},67:function(e,t,a){"use strict";a.r(t);var n,c,r,o,i,l,s=a(0),u=a.n(s),d=a(19),m=a.n(d),p=(a(44),a(38)),E=a(4),v=a(2),S=a(15),b={message:"",show:!1},f=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:b,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_ERROR_MESSAGE":return{message:t.message,show:!0};case"HIDE_ERROR_PANEL":return{message:"",show:!1};default:return e}},g=a(1),O=[{value:"VP8",name:"VP8"},{value:"VP9",name:"VP9"},{value:"42e01f",name:"H.264"}],T={default:{width:{min:"640",ideal:"1280",max:"1920"},height:{min:"360",ideal:"720",max:"1080"},frameRate:"30"},"1920x1080":{width:{exact:"1920"},height:{exact:"1080"},frameRate:"30"},"1280x720":{width:{exact:"1280"},height:{exact:"720"},frameRate:"30"},"800x600":{width:{exact:"800"},height:{exact:"600"},frameRate:"30"},"640x360":{width:{exact:"640"},height:{exact:"360"},frameRate:"30"}},_={stream:void 0,canvas:void 0,audioTracksMap:{},videoTracksMap:{},displayScreenTrack:void 0,cameras:[],microphones:[],constraints:{video:T.default,audio:!0},gotPermissions:!1,devicesLoaded:!1,devicesLoading:!1,userMediaLoaded:!1,userMediaLoading:!1},N=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:_,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_MEDIA_CANVAS":return Object(g.a)(Object(g.a)({},e),{},{canvas:t.canvas});case"SET_MEDIA_CONSTRAINTS":return Object(g.a)(Object(g.a)({},e),{},{constraints:t.constraints});case"SET_MEDIA_STREAM":return Object(g.a)(Object(g.a)({},e),{},{stream:t.stream});case"SET_MEDIA_TRACKS":var a=Object(g.a)({},e);return null!=t.videoTracksMap&&(a.videoTracksMap=t.videoTracksMap),null!=t.audioTracksMap&&(a.audioTracksMap=t.audioTracksMap),null!=t.displayScreenTrack&&(a.displayScreenTrack=t.displayScreenTrack),a;case"SET_MEDIA_GOT_PERMISSIONS":return Object(g.a)(Object(g.a)({},e),{},{gotPermissions:t.gotPermissions});case"SET_MEDIA_CAMERAS":var n=Object(g.a)({},e);if(n.cameras=t.cameras,null==n.constraints.video.deviceId&&t.cameras.length>0){var c=JSON.parse(JSON.stringify(n.constraints));c.video.deviceId=t.cameras[0].deviceId,n.constraints=c}return n;case"SET_MEDIA_MICROPHONES":var r=Object(g.a)({},e);if(r.microphones=t.microphones,null==r.constraints.audio.deviceId&&t.microphones.length>0){var o=JSON.parse(JSON.stringify(r.constraints));"boolean"===typeof o.audio&&(o.audio={}),o.audio.deviceId=t.microphones[0].deviceId,r.constraints=o}return r;case"SET_MEDIA_DEVICES_STATE":var i=Object(g.a)({},e);return null!=t.devicesLoaded&&(i.devicesLoaded=t.devicesLoaded),null!=t.devicesLoading&&(i.devicesLoading=t.devicesLoading),i;case"SET_MEDIA_USERMEDIA_STATE":var l=Object(g.a)({},e);return null!=t.userMediaLoaded&&(l.userMediaLoaded=t.userMediaLoaded),null!=t.userMediaLoading&&(l.userMediaLoading=t.userMediaLoading),l;case"SET_MEDIA_SCREEN_SHARE_ENDED":return Object(g.a)(Object(g.a)({},e),{},{displayScreenTrack:void 0});default:return e}},C={layout:0,signalingURL:"",applicationName:"",streamName:"",streamInfo:void 0,audioBitrate:"64",audioCodec:"opus",audioTrack:void 0,audioTrackDeviceId:"",videoBitrate:"3500",videoTrack:void 0,videoTrack1DeviceId:"",videoTrack2DeviceId:"",videoCodec:"VP8",videoFrameRate:"30",videoFrameSize:"default",userData:void 0,publishStart:!1,publishStarting:!1,publishStop:!1,publishStopping:!1},h=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:C,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_COMPOSITE_LAYOUT":return Object(g.a)(Object(g.a)({},e),{},{layout:t.layout});case"SET_COMPOSITE_SIGNALING_URL":return Object(g.a)(Object(g.a)({},e),{},{signalingURL:t.signalingURL});case"SET_COMPOSITE_APPLICATION_NAME":return Object(g.a)(Object(g.a)({},e),{},{applicationName:t.applicationName});case"SET_COMPOSITE_STREAM_NAME":return Object(g.a)(Object(g.a)({},e),{},{streamName:t.streamName});case"SET_COMPOSITE_STREAM_INFO":return Object(g.a)(Object(g.a)({},e),{},{streamInfo:t.streamInfo});case"SET_COMPOSITE_AUDIO_BITRATE":return Object(g.a)(Object(g.a)({},e),{},{audioBitrate:t.audioBitrate});case"SET_COMPOSITE_AUDIO_CODEC":return Object(g.a)(Object(g.a)({},e),{},{audioCodec:t.audioCodec});case"SET_COMPOSITE_AUDIO_TRACK":return Object(g.a)(Object(g.a)({},e),{},{audioTrack:t.audioTrack});case"SET_COMPOSITE_AUDIO_TRACK_DEVICEID":return Object(g.a)(Object(g.a)({},e),{},{audioTrackDeviceId:t.audioTrackDeviceId});case"SET_COMPOSITE_VIDEO_BITRATE":return Object(g.a)(Object(g.a)({},e),{},{videoBitrate:t.videoBitrate});case"SET_COMPOSITE_VIDEO_CODEC":return Object(g.a)(Object(g.a)({},e),{},{videoCodec:t.videoCodec});case"SET_COMPOSITE_VIDEO_FRAME_SIZE_AND_RATE":var a=Object(g.a)({},e);return null!=t.videoFrameSize&&(a.videoFrameSize=t.videoFrameSize),null!=t.videoFrameRate&&(a.videoFrameRate=t.videoFrameRate),a;case"SET_COMPOSITE_VIDEO_TRACK":return Object(g.a)(Object(g.a)({},e),{},{videoTrack:t.videoTrack});case"SET_COMPOSITE_VIDEO_TRACK1_DEVICEID":return Object(g.a)(Object(g.a)({},e),{},{videoTrack1DeviceId:t.videoTrack1DeviceId});case"SET_COMPOSITE_VIDEO_TRACK2_DEVICEID":return Object(g.a)(Object(g.a)({},e),{},{videoTrack2DeviceId:t.videoTrack2DeviceId});case"SET_COMPOSITE_USER_DATA":return Object(g.a)(Object(g.a)({},e),{},{userData:t.userData});case"SET_COMPOSITE_FLAGS":var n=Object(g.a)({},e);return null!=t.publishStart&&(n.publishStart=t.publishStart),null!=t.publishStarting&&(n.publishStarting=t.publishStarting),null!=t.publishStop&&(n.publishStop=t.publishStop),null!=t.publishStopping&&(n.publishStopping=t.publishStopping),n;default:return e}},I={signalingURL:"",applicationName:"",streamName:"",playStart:!1,playStarting:!1,playStop:!1,playStopping:!1},y=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:I,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_PLAY_SIGNALING_URL":return Object(g.a)(Object(g.a)({},e),{},{signalingURL:t.signalingURL});case"SET_PLAY_APPLICATION_NAME":return Object(g.a)(Object(g.a)({},e),{},{applicationName:t.applicationName});case"SET_PLAY_STREAM_NAME":return Object(g.a)(Object(g.a)({},e),{},{streamName:t.streamName});case"SET_PLAY_FLAGS":var a=Object(g.a)({},e);return null!=t.playStart&&(a.playStart=t.playStart),null!=t.playStarting&&(a.playStarting=t.playStarting),null!=t.playStop&&(a.playStop=t.playStop),null!=t.playStopping&&(a.playStopping=t.playStopping),a;default:return e}},A={signalingURL:"",applicationName:"",streamName:"",streamInfo:void 0,audioBitrate:"64",audioCodec:"opus",audioTrack:{},audioTrackDeviceId:"",videoBitrate:"3500",videoTrack:{},videoTrack1DeviceId:"",videoTrack2DeviceId:"",videoCodec:"VP8",videoFrameRate:"30",videoFrameSize:"default",userData:void 0,publishStart:!1,publishStarting:!1,publishStop:!1,publishStopping:!1},R=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:A,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_PUBLISH_SIGNALING_URL":return Object(g.a)(Object(g.a)({},e),{},{signalingURL:t.signalingURL});case"SET_PUBLISH_APPLICATION_NAME":return Object(g.a)(Object(g.a)({},e),{},{applicationName:t.applicationName});case"SET_PUBLISH_STREAM_NAME":return Object(g.a)(Object(g.a)({},e),{},{streamName:t.streamName});case"SET_PUBLISH_STREAM_INFO":return Object(g.a)(Object(g.a)({},e),{},{streamInfo:t.streamInfo});case"SET_PUBLISH_AUDIO_BITRATE":return Object(g.a)(Object(g.a)({},e),{},{audioBitrate:t.audioBitrate});case"SET_PUBLISH_AUDIO_CODEC":return Object(g.a)(Object(g.a)({},e),{},{audioCodec:t.audioCodec});case"SET_PUBLISH_AUDIO_TRACK":return Object(g.a)(Object(g.a)({},e),{},{audioTrack:t.audioTrack});case"SET_PUBLISH_AUDIO_TRACK_DEVICEID":return Object(g.a)(Object(g.a)({},e),{},{audioTrackDeviceId:t.audioTrackDeviceId});case"SET_PUBLISH_VIDEO_BITRATE":return Object(g.a)(Object(g.a)({},e),{},{videoBitrate:t.videoBitrate});case"SET_PUBLISH_VIDEO_CODEC":return Object(g.a)(Object(g.a)({},e),{},{videoCodec:t.videoCodec});case"SET_PUBLISH_VIDEO_FRAME_SIZE_AND_RATE":var a=Object(g.a)({},e);return null!=t.videoFrameSize&&(a.videoFrameSize=t.videoFrameSize),null!=t.videoFrameRate&&(a.videoFrameRate=t.videoFrameRate),a;case"SET_PUBLISH_VIDEO_TRACK":return Object(g.a)(Object(g.a)({},e),{},{videoTrack:t.videoTrack});case"SET_PUBLISH_VIDEO_TRACK1_DEVICEID":return Object(g.a)(Object(g.a)({},e),{},{videoTrack1DeviceId:t.videoTrack1DeviceId});case"SET_PUBLISH_VIDEO_TRACK2_DEVICEID":return Object(g.a)(Object(g.a)({},e),{},{videoTrack2DeviceId:t.videoTrack2DeviceId});case"SET_PUBLISH_USER_DATA":return Object(g.a)(Object(g.a)({},e),{},{userData:t.userData});case"SET_PUBLISH_FLAGS":var n=Object(g.a)({},e);return null!=t.publishStart&&(n.publishStart=t.publishStart),null!=t.publishStarting&&(n.publishStarting=t.publishStarting),null!=t.publishStop&&(n.publishStop=t.publishStop),null!=t.publishStopping&&(n.publishStopping=t.publishStopping),n;case"TOGGLE_VIDEO_ENABLED":var c=Object(g.a)({},e);return c.videoTrack.enabled=!c.videoTrack.enabled,c;case"TOGGLE_AUDIO_ENABLED":var r=Object(g.a)({},e);return r.audioTrack.enabled=!r.audioTrack.enabled,r;default:return e}},w={websocket:void 0,peerConnection:void 0,peerConnectionVideoSender:void 0,peerConnectionAudioSender:void 0,connected:!1},k=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:w,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_WEBRTC_PUBLISH_WEBSOCKET":return Object(g.a)(Object(g.a)({},e),{},{websocket:t.websocket});case"SET_WEBRTC_PUBLISH_PEERCONNECTION":return Object(g.a)(Object(g.a)({},e),{},{peerConnection:t.peerConnection});case"SET_WEBRTC_PUBLISH_CONNECTED":return Object(g.a)(Object(g.a)({},e),{},{connected:t.connected});case"SET_WEBRTC_PUBLISH_PEERCONNECTION_AUDIO_SENDER":return Object(g.a)(Object(g.a)({},e),{},{peerConnectionAudioSender:t.peerConnectionAudioSender});case"SET_WEBRTC_PUBLISH_PEERCONNECTION_VIDEO_SENDER":return Object(g.a)(Object(g.a)({},e),{},{peerConnectionVideoSender:t.peerConnectionVideoSender});default:return e}},P={websocket:void 0,peerConnection:void 0,audioTrack:void 0,videoTrack:void 0,connected:!1},j=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:P,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_WEBRTC_PLAY_WEBSOCKET":return Object(g.a)(Object(g.a)({},e),{},{websocket:t.websocket});case"SET_WEBRTC_PLAY_PEERCONNECTION":return Object(g.a)(Object(g.a)({},e),{},{peerConnection:t.peerConnection});case"SET_WEBRTC_PLAY_AUDIO_TRACK":return Object(g.a)(Object(g.a)({},e),{},{audioTrack:t.audioTrack});case"SET_WEBRTC_PLAY_VIDEO_TRACK":return Object(g.a)(Object(g.a)({},e),{},{videoTrack:t.videoTrack});case"SET_WEBRTC_PLAY_CONNECTED":return Object(g.a)(Object(g.a)({},e),{},{connected:t.connected});default:return e}},L=function(e,t){return new Promise((function(a,n){console.log("checking add"),0===e.filter((function(e){return e.streamName.includes(t)})).length&&(console.log("adding: "+t),a({type:"ADD_PEER_VIDEO_PLAYER",peerStream:{streamName:t}}))}))},D=function(e,t){return new Promise((function(a,n){console.log("checking remove"),e.find((function(e){return e.streamName.includes(t)}))||(console.log("removing: "+t),a({type:"REMOVE_PEER_VIDEO_PLAYER",streamName:t}))}))},M={websocket:void 0,peerConnection:void 0,peerConnectionVideoSender:void 0,peerConnectionAudioSender:void 0,connected:!1,peerStreams:[]},B=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:M,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_WEBRTC_MEETING_WEBSOCKET":return Object(g.a)(Object(g.a)({},e),{},{websocket:t.websocket});case"SET_WEBRTC_MEETING_PEERCONNECTION":return Object(g.a)(Object(g.a)({},e),{},{peerConnection:t.peerConnection});case"SET_WEBRTC_MEETING_CONNECTED":return Object(g.a)(Object(g.a)({},e),{},{connected:t.connected});case"SET_WEBRTC_MEETING_PEERCONNECTION_AUDIO_SENDER":return Object(g.a)(Object(g.a)({},e),{},{peerConnectionAudioSender:t.peerConnectionAudioSender});case"SET_WEBRTC_MEETING_PEERCONNECTION_VIDEO_SENDER":return Object(g.a)(Object(g.a)({},e),{},{peerConnectionVideoSender:t.peerConnectionVideoSender});case"ADD_PEER_VIDEO_PLAYER":return(n=e.peerStreams.slice()).push(t.peerStream),Object(g.a)(Object(g.a)({},e),{},{peerStreams:n});case"REMOVE_PEER_VIDEO_PLAYER":return console.log("reducer: "+t),n=(n=e.peerStreams.slice()).filter((function(e){return!(e.streamName===t.streamName)})),console.log(n),Object(g.a)(Object(g.a)({},e),{},{peerStreams:n});case"REMOVE_ALL_PLAYERS":return Object(g.a)(Object(g.a)({},e),{},{peerStreams:[]});default:return e}},U=Object(S.b)({errors:f,media:N,compositeSettings:h,playSettings:y,publishSettings:R,webrtcPublish:k,webrtcPlay:j,webrtcMeeting:B}),x=Object(S.c)(U,window.__REDUX_DEVTOOLS_EXTENSION__&&window.__REDUX_DEVTOOLS_EXTENSION__()),V=a(31),W=a.n(V),G=function(){return u.a.createElement("nav",{className:"navbar navbar-expand-sm navbar-light bg-light pb-3 pb-md-2",id:"top-nav"},u.a.createElement("a",{className:"navbar-brand",href:"https://www.wowza.com"},u.a.createElement("img",{className:"noll",src:W.a,alt:"Wowza Media Systems"})),u.a.createElement("ul",{className:"navbar-nav mr-auto-lg"},u.a.createElement("li",{className:"nav-item page"},u.a.createElement("a",{href:"https://www.wowza.com/developer/webrtc/dev-view-publish"},"Publish"),u.a.createElement("span",null)),u.a.createElement("li",{className:"nav-item page"},u.a.createElement("a",{href:"https://www.wowza.com/developer/webrtc/dev-view-play"},"Play"),u.a.createElement("span",null)),u.a.createElement("li",{className:"nav-item page active"},"Composite",u.a.createElement("span",null))),u.a.createElement("ul",{className:"navbar-nav ml-auto d-none d-md-flex"},u.a.createElement("li",{className:"nav-item mr-3"},u.a.createElement("a",{href:"https://www.wowza.com/docs/wowza-streaming-engine-product-articles"},"Docs")),u.a.createElement("li",{className:"nav-item mr-3"},u.a.createElement("a",{href:"https://www.wowza.com/developer"},"Developer Portal"))))},H=function(){var e=Object(v.b)(),t=Object(v.c)((function(e){return e.errors}));return!1===t.show?null:u.a.createElement("div",{className:"row justify-content-center mt-3",id:"error-panel"},u.a.createElement("div",{className:"col-10 alert alert-danger alert-dismissible p-2"},u.a.createElement("button",{id:"error-panel-close",type:"button",className:"close","aria-label":"Close",onClick:function(){return e({type:"HIDE_ERROR_PANEL"})}},u.a.createElement("span",{"aria-hidden":"true"},"\xd7")),u.a.createElement("div",{id:"error-messages"},t.message)))},F=function(){return Object(v.c)((function(e){return e.webrtcPublish})).connected?u.a.createElement("div",{id:"video-live-indicator"},u.a.createElement("span",{id:"video-live-indicator-live",className:"badge badge-pill badge-danger"},"LIVE")):null},Y=a(5),K=a(12),J=a.n(K),z=["signalingURL","applicationName","streamName","audioBitrate","audioCodec","videoBitrate","videoCodec"],q=a(18),X=a.n(q),Z=function(e){var t={},a=X.a.get(e);return null!=a&&(t=JSON.parse(unescape(a))),t},$=function(){var e=Object(v.b)(),t=Object(s.useState)(!1),a=Object(Y.a)(t,2),n=a[0],c=a[1],r=Object(v.c)((function(e){return e.compositeSettings}));return Object(s.useEffect)((function(){var t=Z("webrtcReactValues"),a=J.a.parse(window.location.search),n=Object(g.a)(Object(g.a)({},t),a);for(var r in n)switch(r){case"composite.signalingURL":e({type:"SET_COMPOSITE_SIGNALING_URL",signalingURL:n[r]});break;case"composite.applicationName":e({type:"SET_COMPOSITE_APPLICATION_NAME",applicationName:n[r]});break;case"composite.streamName":e({type:"SET_COMPOSITE_STREAM_NAME",streamName:n[r]});break;case"composite.audioBitrate":e({type:"SET_COMPOSITE_AUDIO_BITRATE",audioBitrate:n[r]});break;case"composite.audioCodec":e({type:"SET_COMPOSITE_AUDIO_CODEC",audioCodec:n[r]});break;case"composite.videoBitrate":e({type:"SET_COMPOSITE_VIDEO_BITRATE",videoBitrate:n[r]});break;case"composite.videoCodec":e({type:"SET_COMPOSITE_VIDEO_CODEC",videoCodec:n[r]})}c(!0)}),[e]),Object(s.useEffect)((function(){for(var e,t,a=Z("webrtcReactValues"),n=0;n<z.length;n++)null!=r[z[n]]&&(a["composite."+z[n]]=r[z[n]]);e="webrtcReactValues",t=a,X.a.set(e,escape(JSON.stringify(t)))}),[r]),n?u.a.createElement("form",{id:"publish-settings-form"},u.a.createElement("div",{className:"row"},u.a.createElement("div",{className:"col-12"},u.a.createElement("div",{className:"form-group"},u.a.createElement("label",{htmlFor:"sdpURL"},"Signaling URL"),u.a.createElement("input",{type:"text",className:"form-control",id:"signalingURL",name:"signalingURL",maxLength:"1024",placeholder:"wss://[ssl-certificate-domain-name]/webrtc-session.json",value:r.signalingURL,onChange:function(t){return e({type:"SET_COMPOSITE_SIGNALING_URL",signalingURL:t.target.value})}})))),u.a.createElement("div",{className:"row"},u.a.createElement("div",{className:"col-lg-6 col-sm-12"},u.a.createElement("div",{className:"form-group"},u.a.createElement("label",{htmlFor:"applicationName"},"Application Name"),u.a.createElement("input",{type:"text",className:"form-control",id:"applicationName",name:"applicationName",maxLength:"256",value:r.applicationName,onChange:function(t){return e({type:"SET_COMPOSITE_APPLICATION_NAME",applicationName:t.target.value})}}))),u.a.createElement("div",{className:"col-lg-6 col-sm-12"},u.a.createElement("div",{className:"form-group"},u.a.createElement("label",{htmlFor:"streamName"},"Stream Name"),u.a.createElement("input",{type:"text",className:"form-control",id:"streamName",name:"streamName",maxLength:"256",value:r.streamName,onChange:function(t){return e({type:"SET_COMPOSITE_STREAM_NAME",streamName:t.target.value})}})))),u.a.createElement("div",{className:"row"},u.a.createElement("div",{className:"col-lg-6 col-sm-12"},u.a.createElement("div",{className:"form-group"},u.a.createElement("label",{htmlFor:"audioBitrate"},"Audio Bitrate"),u.a.createElement("div",{className:"input-group"},u.a.createElement("input",{type:"number",className:"form-control",id:"audioBitrate",name:"audioBitrate",value:r.audioBitrate,onChange:function(t){return e({type:"SET_COMPOSITE_AUDIO_BITRATE",audioBitrate:t.target.value})}}),u.a.createElement("div",{className:"input-group-append"},u.a.createElement("span",{className:"input-group-text"},"Kbps"))))),u.a.createElement("div",{className:"col-lg-6 col-sm-12"},u.a.createElement("div",{className:"form-group"},u.a.createElement("label",{htmlFor:"audioCodec"},"Audio Codec"),u.a.createElement("div",{className:"input-group"},u.a.createElement("select",{className:"form-control",id:"audioCodec",name:"audioCodec",value:"opus",readOnly:!0},u.a.createElement("option",{value:"opus"},"Opus")))))),u.a.createElement("div",{className:"row"},u.a.createElement("div",{className:"col-lg-6 col-sm-12"},u.a.createElement("div",{className:"form-group"},u.a.createElement("label",{htmlFor:"videoBitrate"},"Video Bitrate"),u.a.createElement("div",{className:"input-group"},u.a.createElement("input",{type:"number",className:"form-control",id:"videoBitrate",name:"videoBitrate",value:r.videoBitrate,onChange:function(t){return e({type:"SET_COMPOSITE_VIDEO_BITRATE",videoBitrate:t.target.value})}}),u.a.createElement("div",{className:"input-group-append"},u.a.createElement("span",{className:"input-group-text"},"Kbps"))))),u.a.createElement("div",{className:"col-lg-6 col-sm-12"},u.a.createElement("div",{className:"form-group"},u.a.createElement("label",{htmlFor:"videoCodec"},"Video Codec"),u.a.createElement("div",{className:"input-group"},u.a.createElement("select",{className:"form-control",id:"videoCodec",name:"videoCodec",value:r.videoCodec,onChange:function(t){return e({type:"SET_COMPOSITE_VIDEO_CODEC",videoCodec:t.target.value})}},O.map((function(e,t){return u.a.createElement("option",{key:t,value:e.value},e.name)})))))))):null},Q=function(e,t){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,n=t.height/e.height,c=t.width/e.width,r=Math.max(n,c);return{width:e.width*r*a,height:e.height*r*a}},ee=function(e,t){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,n=t.height/e.height,c=t.width/e.width,r=Math.min(n,c);return{width:e.width*r*a,height:e.height*r*a}},te=function(e,t,a,n){var c=t.height*n,r=t.width*n;return 2===e||3===e?{top:c,left:t.width-a.width-r}:4===e?{top:c,left:r}:5===e?{top:t.height-a.height-c,left:r}:6===e?{top:t.height-a.height-c,left:t.width-a.width-r}:{top:0,left:0}},ae=function(){var e=Object(s.useState)(!1),t=Object(Y.a)(e,2),a=t[0],n=t[1],c=Object(s.useRef)(null),r=Object(s.useRef)("fill"),o=Object(s.useRef)(null),i=Object(s.useRef)(null),l=Object(s.useRef)(null),d=Object(v.b)(),m=Object(v.c)((function(e){return e.media})),p=m.videoTracksMap,E=m.displayScreenTrack,S=m.audioTracksMap,b=Object(v.c)((function(e){return e.compositeSettings})),f=b.videoTrack1DeviceId,g=b.videoTrack2DeviceId,O=b.audioTrackDeviceId,T=b.layout;l.current=T,Object(s.useEffect)((function(){var e=void 0;"screen"===f&&null!=E?((e=new MediaStream).addTrack(E),r.current="fit"):""!==f&&"screen"!==f&&null!=p[f]&&((e=new MediaStream).addTrack(p[f]),r.current="fill"),null!=c&&null!=c.current&&(c.current.srcObject=e)}),[p,f,c,E]),Object(s.useEffect)((function(){var e=void 0;""!==g&&null!=p[g]&&(e=new MediaStream).addTrack(p[g]),null!=o&&null!=o.current&&(o.current.srcObject=e)}),[p,g,o]),Object(s.useEffect)((function(){var e=void 0;""!==O&&null!=S[O]&&(e=S[O]),null!=e&&d({type:"SET_COMPOSITE_AUDIO_TRACK",audioTrack:e})}),[d,S,O]),Object(s.useEffect)((function(){l.current=T}),[T]);var _=Object(s.useRef)(new(window.AudioContext||window.webkitAudioContext)),N=Object(s.useRef)(),C=Object(s.useCallback)((function(){null!=c.current&&null!=o.current&&null!=i.current&&(N.current=_.current.createOscillator(),N.current.onended=function(){C()},N.current.start(),N.current.stop(1/30),function(e,t,a,n,c){var r=a.getContext("2d");a.width=1280,a.height=720,r.fillStyle="gray",r.fillRect(0,0,a.width,a.height);var o=0===n||2===n||4===n||5===n||6===n,i=3===n,l=1===n||3===n,s=2===n||4===n||5===n||6===n,u={width:a.width,height:a.height},d={width:e.videoWidth,height:e.videoHeight},m={width:t.videoWidth,height:t.videoHeight};if(o&&e.readyState===e.HAVE_ENOUGH_DATA){var p="fill"===c?Q(d,u,1):ee(d,u,1),E=(u.width-p.width)/2,v=(u.height-p.height)/2;r.drawImage(e,E,v,p.width,p.height)}if(l&&t.readyState===t.HAVE_ENOUGH_DATA){var S=Q(m,u,1),b=(u.width-S.width)/2,f=(u.height-S.height)/2;r.drawImage(t,b,f,S.width,S.height)}if(i&&e.readyState===e.HAVE_ENOUGH_DATA){var g=ee(d,u,1/4),O=te(n,u,g,1/16);r.drawImage(e,O.left,O.top,g.width,g.height)}if(s&&t.readyState===t.HAVE_ENOUGH_DATA){var T=ee(m,u,1/4),_=te(n,u,T,1/16);r.drawImage(t,_.left,_.top,T.width,T.height)}if(7===n){if(e.readyState===e.HAVE_ENOUGH_DATA){var N=ee(d,u,.5),C=(u.width/2-N.width)/2,h=u.height/2-N.height/2;r.drawImage(e,C,h,N.width,N.height)}if(t.readyState===t.HAVE_ENOUGH_DATA){var I=ee(m,u,.5),y=u.width-I.width+(u.width/2-I.width)/2,A=u.height/2-I.height/2;r.drawImage(t,y,A,I.width,I.height)}}}(c.current,o.current,i.current,l.current,r.current))}),[]);return Object(s.useEffect)((function(){_.current.resume().then((function(){a||(n(!0),C())}))}),[a,C,f,g,O]),Object(s.useEffect)((function(){var e=i.current.captureStream(30);d({type:"SET_COMPOSITE_VIDEO_TRACK",videoTrack:e.getTracks()[0]})}),[d]),u.a.createElement(u.a.Fragment,null,u.a.createElement("canvas",{ref:i,id:"publisher-canvas"}),u.a.createElement("video",{ref:c,id:"publisher-video1",autoPlay:!0,style:{display:"none"}}),u.a.createElement("video",{ref:o,id:"publisher-video2",autoPlay:!0,style:{display:"none"}}))},ne=a(32),ce=a.n(ne),re=function(e){var t=e.settings,a=e.parameters,n=e.prefix;return u.a.createElement("button",{id:n+"-share-link",type:"button",className:"control-button mt-0",onClick:function(e){for(var c={},r=0;r<a.length;r++)null!=t[a[r]]&&(c[n+a[r]]=t[a[r]]);var o=window.location.origin+window.location.pathname;!function(e,t){if(null!==e&&void 0!==e&&0!==e.length){navigator.clipboard.writeText(e).then((function(){a()}),(function(){e.select(),document.execCommand("copy"),a()}));var a=function(){t?alert(t):alert("Copied!")}}else alert("Copy failed :(")}(J.a.stringifyUrl({url:o,query:c}))}},u.a.createElement("img",{alt:"",className:"noll",id:n+"-share-img",src:ce.a}))},oe=(a(61),function(){var e=Object(v.b)(),t=Object(v.c)((function(e){return e.compositeSettings})),a=Object(v.c)((function(e){return e.media})),n=a.cameras,c=a.microphones,r=Object(v.c)((function(e){return e.webrtcPublish}));return u.a.createElement("form",{id:"composite-settings-form-2"},u.a.createElement("div",{className:"row"},u.a.createElement("div",{className:"col-md-4 col-sm-12"},u.a.createElement("div",{className:"row"},u.a.createElement("div",{className:"col-10"},u.a.createElement("div",{className:"form-group"},u.a.createElement("label",{htmlFor:"camera1-list-select"},"Video Input 1"),u.a.createElement("select",{id:"camera1-list-select",className:"form-control",value:t.videoTrack1DeviceId,onChange:function(t){return e({type:"SET_COMPOSITE_VIDEO_TRACK1_DEVICEID",videoTrack1DeviceId:t.target.value})}},u.a.createElement("option",{value:""},"None"),n.map((function(e,t){return u.a.createElement("option",{key:t,value:e.deviceId},e.label)})),u.a.createElement("option",{value:"screen"},"Screen Share"))))),u.a.createElement("div",{className:"row"},u.a.createElement("div",{className:"col-10"},u.a.createElement("div",{className:"form-group"},u.a.createElement("label",{htmlFor:"camera2-list-select"},"Video Input 2"),u.a.createElement("select",{id:"camera2-list-select",className:"form-control",value:t.videoTrack2DeviceId,onChange:function(t){return e({type:"SET_COMPOSITE_VIDEO_TRACK2_DEVICEID",videoTrack2DeviceId:t.target.value})}},u.a.createElement("option",{value:""},"None"),n.map((function(e,t){return u.a.createElement("option",{key:t,value:e.deviceId},e.label)})))))),u.a.createElement("div",{className:"row"},u.a.createElement("div",{className:"col-10"},u.a.createElement("div",{className:"form-group"},u.a.createElement("label",{htmlFor:"mic-list-select"},"Microphone"),u.a.createElement("select",{id:"mic-list-select",className:"form-control",value:t.audioTrackDeviceId,onChange:function(t){return e({type:"SET_COMPOSITE_AUDIO_TRACK_DEVICEID",audioTrackDeviceId:t.target.value})}},u.a.createElement("option",{value:""},"None"),c.map((function(e,t){return u.a.createElement("option",{key:t,value:e.deviceId},e.label)}))))))),u.a.createElement("div",{className:"col-md-8 col-sm-12"},u.a.createElement("label",null,"Layout"),u.a.createElement("div",{className:"row composite-layout"},u.a.createElement("div",{className:"col-lg-3 col-6 mb-4"},u.a.createElement("button",{id:"composite-layout-0",type:"button",className:"btn composite-layout-button"+(0===t.layout?" btn-outline-warning":" btn-outline-secondary"),onClick:function(t){return e({type:"SET_COMPOSITE_LAYOUT",layout:0})}},u.a.createElement("span",{className:"composite-layout-button-label"},"1"))),u.a.createElement("div",{className:"col-lg-3 col-6 mb-4"},u.a.createElement("button",{id:"composite-layout-1",type:"button",className:"btn composite-layout-button"+(1===t.layout?" btn-outline-warning":" btn-outline-secondary"),onClick:function(t){return e({type:"SET_COMPOSITE_LAYOUT",layout:1})}},u.a.createElement("span",{className:"composite-layout-button-label"},"2"))),u.a.createElement("div",{className:"col-lg-3 col-6 mb-4"},u.a.createElement("button",{id:"composite-layout-2",type:"button",className:"btn composite-layout-button"+(2===t.layout?" btn-outline-warning":" btn-outline-secondary"),onClick:function(t){return e({type:"SET_COMPOSITE_LAYOUT",layout:2})}},u.a.createElement("div",{className:"composite-layout-pip pip-top-right"},"2"),u.a.createElement("span",{className:"composite-layout-button-label"},"1"))),u.a.createElement("div",{className:"col-lg-3 col-6 mb-4"},u.a.createElement("button",{id:"composite-layout-3",type:"button",className:"btn composite-layout-button"+(3===t.layout?" btn-outline-warning":" btn-outline-secondary"),onClick:function(t){return e({type:"SET_COMPOSITE_LAYOUT",layout:3})}},u.a.createElement("div",{className:"composite-layout-pip pip-top-right"},"1"),u.a.createElement("span",{className:"composite-layout-button-label"},"2"))),u.a.createElement("div",{className:"col-lg-3 col-6 mb-4"},u.a.createElement("button",{id:"composite-layout-4",type:"button",className:"btn composite-layout-button"+(4===t.layout?" btn-outline-warning":" btn-outline-secondary"),onClick:function(t){return e({type:"SET_COMPOSITE_LAYOUT",layout:4})}},u.a.createElement("div",{className:"composite-layout-pip pip-top-left"},"2"),u.a.createElement("span",{className:"composite-layout-button-label"},"1"))),u.a.createElement("div",{className:"col-lg-3 col-6 mb-4"},u.a.createElement("button",{id:"composite-layout-5",type:"button",className:"btn composite-layout-button"+(5===t.layout?" btn-outline-warning":" btn-outline-secondary"),onClick:function(t){return e({type:"SET_COMPOSITE_LAYOUT",layout:5})}},u.a.createElement("div",{className:"composite-layout-pip pip-bottom-left"},"2"),u.a.createElement("span",{className:"composite-layout-button-label"},"1"))),u.a.createElement("div",{className:"col-lg-3 col-6 mb-4"},u.a.createElement("button",{id:"composite-layout-6",type:"button",className:"btn composite-layout-button"+(6===t.layout?" btn-outline-warning":" btn-outline-secondary"),onClick:function(t){return e({type:"SET_COMPOSITE_LAYOUT",layout:6})}},u.a.createElement("div",{className:"composite-layout-pip pip-bottom-right"},"2"),u.a.createElement("span",{className:"composite-layout-button-label"},"1"))),u.a.createElement("div",{className:"col-lg-3 col-6 mb-4"},u.a.createElement("button",{id:"composite-layout-7",type:"button",className:"btn composite-layout-button"+(7===t.layout?" btn-outline-warning":" btn-outline-secondary"),onClick:function(t){return e({type:"SET_COMPOSITE_LAYOUT",layout:7})}},u.a.createElement("div",{className:"composite-layout-quarter quarter-left"},"1"),u.a.createElement("div",{className:"composite-layout-quarter quarter-right"},"2")))))),u.a.createElement("div",{className:"row"},u.a.createElement("div",{className:"col-0 col-md-8"}),u.a.createElement("div",{className:"col-12 col-md-4"},u.a.createElement("div",{className:"row"},u.a.createElement("div",{className:"col-10"},!r.connected&&u.a.createElement("button",{id:"publish-toggle",type:"button",className:"btn",disabled:t.publishStarting,onClick:function(t){return e({type:"SET_COMPOSITE_FLAGS",publishStart:!0})}},"Publish"),r.connected&&u.a.createElement("button",{id:"publish-toggle",type:"button",className:"btn",onClick:function(t){return e({type:"SET_COMPOSITE_FLAGS",publishStop:!0})}},"Stop")),u.a.createElement("div",{className:"col-2"},u.a.createElement(re,{settings:t,parameters:z,prefix:"composite."}))))))}),ie=a(21),le=ie.a.browserDetails;function se(e,t){for(var a in c){var n=c[a];if(n.includes(e)){if(e.includes("VP9")||e.includes("VP8")){var r="",o=n.split(/\r\n/);for(var s in o){r+=o[s],r+="\r\n"}return t.includes("audio")&&(l=a),t.includes("video")&&(i=a),r}return t.includes("audio")&&(l=a),t.includes("video")&&(i=a),n}}return""}function ue(e){if(e.startsWith("a=rtpmap")||e.startsWith("a=rtcp-fb")||e.startsWith("a=fmtp")){var t=e.split(":");if(t.length>1){var a=t[1].split(" ");if(!isNaN(a[0])&&!a[1].startsWith("http")&&!a[1].startsWith("ur")){var n=c[a[0]];return n||(n=""),n+=e+"\r\n",c[a[0]]=n,!1}}}return!0}function de(e){var t=new RegExp("a=rtpmap:(\\d+) (\\w+)/(\\d+)"),a=e.match(t);return a&&a.length>=3?a:null}var me=function(e,t,a,n,s){console.log("peerConnectionCreateOfferSuccess: SDP:"),console.log(e.sdp+"");var u={};null!=t.audioBitrate&&(u.audioBitrate=t.audioBitrate),null!=t.videoBitrate&&(u.videoBitrate=t.videoBitrate),null!=t.videoFrameRate&&(u.videoFrameRate=t.videoFrameRate),null!=t.videoCodec&&(u.videoCodec=t.videoCodec),null!=t.audioCodec&&(u.audioCodec=t.audioCodec),e.sdp=function(e,t){c={},r="42e01f",o="opus",i=-1,l=-1;var a=e.split(/\r\n/),n="header",s=!1,u="";for(var d in null!=t.videoCodec&&""!==t.videoCodec&&(r=t.videoCodec),null!=t.audioCodec&&""!==t.audioCodec&&(o=t.audioCodec),a){var m=a[d];if(!(m.length<=0))ue(m)&&(u+=m,u+="\r\n")}for(var p in u=function(e,t){var a=e.split(/\r\n/),n="",c=!1,r=!1;for(var o in a){var i=a[o];i.length<=0||i.includes("a=rtcp-rsize")&&(r=!0)}for(var l in a){var s=a[l];n+=s,n+="\r\n",0==="a=rtcp-rsize".localeCompare(s)&&!1===c&&!0===r&&(n+=t,c=!0),0==="a=rtcp-mux".localeCompare(s)&&!0===c&&!1===r&&(n+=t,c=!0),0==="a=rtcp-mux".localeCompare(s)&&!1===c&&!1===r&&(c=!0)}return n}(u=function(e,t){var a=e.split(/\r\n/),n="",c=!1;for(var r in a){var o=a[r];o.length<=0||(n+=o,n+="\r\n",0==="a=rtcp-mux".localeCompare(o)&&!1===c&&(n+=t,c=!0))}return n}(u,se(o,"audio")),se(r,"video")),e=u,u="",a=e.split(/\r\n/)){var E=a[p];if(!(E.length<=0)){if("chrome"===le.browser){var v=void 0;if(0===E.indexOf("m=audio")&&-1!==l){u+=(v=E.split(" "))[0]+" "+v[1]+" "+v[2]+" "+l+"\r\n";continue}if(0===E.indexOf("m=video")&&-1!==i){u+=(v=E.split(" "))[0]+" "+v[1]+" "+v[2]+" "+i+"\r\n";continue}}if(u+=E,0===E.indexOf("m=audio")?(n="audio",s=!1):0===E.indexOf("m=video")?(n="video",s=!1):0===E.indexOf("a=rtpmap")&&(n="bandwidth",s=!1),"chrome"===le.browser&&(0===E.indexOf("a=mid:")||0===E.indexOf("a=rtpmap"))&&!s)if(0==="audio".localeCompare(n))void 0!==t.audioBitrate&&(u+="\r\nb=CT:"+t.audioBitrate,u+="\r\nb=AS:"+t.audioBitrate),s=!0;else if(0==="video".localeCompare(n))void 0!==t.videoBitrate&&(u+="\r\nb=CT:"+t.videoBitrate,u+="\r\nb=AS:"+t.videoBitrate,void 0!==t.videoFrameRate&&(u+="\r\na=framerate:"+t.videoFrameRate)),s=!0;else if(0==="bandwidth".localeCompare(n)){var S=void 0;if(null!==(S=de(E))){var b=S[2].toLowerCase();0!=="vp9".localeCompare(b)&&0!=="vp8".localeCompare(b)&&0!=="h264".localeCompare(b)&&0!=="red".localeCompare(b)&&0!=="ulpfec".localeCompare(b)&&0!=="rtx".localeCompare(b)||void 0!==t.videoBitrate&&(u+="\r\na=fmtp:"+S[1]+" x-google-min-bitrate="+t.videoBitrate+";x-google-max-bitrate="+t.videoBitrate),0!=="opus".localeCompare(b)&&0!=="isac".localeCompare(b)&&0!=="g722".localeCompare(b)&&0!=="pcmu".localeCompare(b)&&0!=="pcma".localeCompare(b)&&0!=="cn".localeCompare(b)||void 0!==t.audioBitrate&&(u+="\r\na=fmtp:"+S[1]+" x-google-min-bitrate="+t.audioBitrate+";x-google-max-bitrate="+t.audioBitrate)}}if(("firefox"===le.browser||"safari"===le.browser)&&0===E.indexOf("c=IN")){if(0==="audio".localeCompare(n)){""!==t.audioBitrate&&(u+="\r\nb=TIAS:"+1e3*Number(t.audioBitrate)+"\r\n",u+="b=AS:"+1e3*Number(t.audioBitrate)+"\r\n",u+="b=CT:"+1e3*Number(t.audioBitrate)+"\r\n");continue}if(0==="video".localeCompare(n)){""!==t.videoBitrate&&(u+="\r\nb=TIAS:"+1e3*Number(t.videoBitrate)+"\r\n",u+="b=AS:"+1e3*Number(t.videoBitrate)+"\r\n",u+="b=CT:"+1e3*Number(t.videoBitrate)+"\r\n");continue}}u+="\r\n"}}return u}(e.sdp,u),console.log("peerConnectionCreateOfferSuccess: Setting local description SDP: "),console.log(e.sdp),n.setLocalDescription(e).then((function(){return a.send('{"direction":"publish", "command":"sendOffer", "streamInfo":'+JSON.stringify(function(e){return{applicationName:e.applicationName,streamName:e.streamName,sessionId:"[empty]"}}(t))+', "sdp":'+JSON.stringify(e)+', "userData":'+JSON.stringify({param1:"value1"})+"}")})).catch((function(e){var t=Object(g.a)({message:"Peer connection failed"},e);pe(t,s)}))},pe=function(e,t){console.log("peerConnectionOnError"),console.log(e),t.onError&&t.onError({message:"PeerConnection Error: "+e.message})},Ee=function(e,t,a,n){var c=JSON.parse(e.data),r=Number(c.status);if(504===r)console.log("New stream connecting to Wowza Streaming Engine");else if(200!==r)ve({message:c.statusDescription},n);else{var o=c.sdp;if(void 0!==o){var i={};void 0!==t.audioBitrate&&(i.audioBitrate=t.audioBitrate),void 0!==t.videoBitrate&&(i.videoBitrate=t.videoBitrate),console.log("Setting remote description SDP:"),console.log(o.sdp),a.setRemoteDescription(new RTCSessionDescription(o),(function(){}),(function(e){pe(e,n)}))}var l=c.iceCandidates;if(void 0!==l)for(var s in l)console.log("websocketOnMessage.iceCandidates: "+l[s]),a.addIceCandidate(new RTCIceCandidate(l[s]))}},ve=function(e,t){console.log("Websocket Error"),console.log(e),t.onError&&t.onError({message:"Websocket Error: "+e.message})},Se=function(e,t,a){try{null==t&&(t=new WebSocket(e.signalingURL)),null!=t&&(t.binaryType="arraybuffer",t.addEventListener("open",(function(){!function(e,t,a){var n;try{(n=new RTCPeerConnection).onnegotiationneeded=function(c){n.createOffer().then((function(c){me(c,e,t,n,a)})).catch((function(e){pe(e,a)}))},n.onconnectionstatechange=function(e){"connected"===e.currentTarget.connectionState?a.onConnectionStateChange&&a.onConnectionStateChange({connected:!0}):a.onConnectionStateChange&&a.onConnectionStateChange({connected:!1})};var c=void 0,r=void 0;null!=e.audioTrack&&(c=n.addTrack(e.audioTrack)),null!=e.videoTrack&&(r=n.addTrack(e.videoTrack)),a.onSetSenders&&a.onSetSenders({audioSender:c,videoSender:r}),t.addEventListener("message",(function(t){Ee(t,e,n,a)}))}catch(o){ve(o,a)}a.onSetPeerConnection&&a.onSetPeerConnection({peerConnection:n})}(e,t,a)})),t.addEventListener("error",(function(e){ve(e,a)})),a.onSetWebsocket&&a.onSetWebsocket({websocket:t}))}catch(n){a.onError&&a.onError(n)}},be=function(e,t,a){null!=e&&(e.close(),a.onSetPeerConnection&&a.onSetPeerConnection({peerConnection:void 0})),null!=t&&(t.close(),a.onSetWebsocket&&a.onSetWebsocket({websocket:void 0})),a.onPublishStopped&&a.onPublishStopped()},fe=function(){var e=Object(v.b)(),t=Object(v.c)((function(e){return e.compositeSettings})),a=Object(v.c)((function(e){return e.webrtcPublish}));return Object(s.useEffect)((function(){!t.publishStart||t.publishStarting||a.connected||(e({type:"SET_COMPOSITE_FLAGS",publishStart:!1,publishStarting:!0}),Se(t,a.websocket,{onError:function(t){e({type:"SET_ERROR_MESSAGE",message:t.message})},onConnectionStateChange:function(t){e({type:"SET_WEBRTC_PUBLISH_CONNECTED",connected:t.connected})},onSetPeerConnection:function(t){e({type:"SET_WEBRTC_PUBLISH_PEERCONNECTION",peerConnection:t.peerConnection})},onSetWebsocket:function(t){e({type:"SET_WEBRTC_PUBLISH_WEBSOCKET",websocket:t.websocket})},onSetSenders:function(t){e({type:"SET_WEBRTC_PUBLISH_PEERCONNECTION_AUDIO_SENDER",peerConnectionAudioSender:t.audioSender}),e({type:"SET_WEBRTC_PUBLISH_PEERCONNECTION_VIDEO_SENDER",peerConnectionVideoSender:t.videoSender})}})),t.publishStarting&&a.connected&&e({type:"SET_COMPOSITE_FLAGS",publishStarting:!1}),t.publishStop&&!t.publishStopping&&a.connected&&(e({type:"SET_COMPOSITE_FLAGS",publishStop:!1,publishStopping:!0}),be(a.peerConnection,a.websocket,{onSetPeerConnection:function(t){e({type:"SET_WEBRTC_PUBLISH_PEERCONNECTION",peerConnection:t.peerConnection})},onSetWebsocket:function(t){e({type:"SET_WEBRTC_PUBLISH_WEBSOCKET",websocket:t.websocket})},onPublishStopped:function(){e({type:"SET_WEBRTC_PUBLISH_CONNECTED",connected:!1})}})),t.publishStopping&&!a.connected&&e({type:"SET_COMPOSITE_FLAGS",publishStopping:!1})}),[e,t,a]),u.a.createElement(u.a.Fragment,null)},ge=(a(62),function(){return"safari"===ie.a.browserDetails.browser?u.a.createElement("div",{className:"container-fluid mt-3",id:"composite-content"},u.a.createElement("div",{id:"composite-content-inner"},u.a.createElement("div",{className:"row justify-content-center"},"Composite example not supported in Safari"))):u.a.createElement("div",{className:"container-fluid mt-3",id:"composite-content"},u.a.createElement("div",{id:"composite-content-inner"},u.a.createElement("div",{className:"row justify-content-center"},u.a.createElement("div",{className:"col-md-8 col-sm-12"},u.a.createElement("div",{id:"composite-video-container",className:"mb-4"},u.a.createElement(ae,null),u.a.createElement(F,null))),u.a.createElement("div",{className:"col-md-4 col-sm-12"},u.a.createElement($,null))),u.a.createElement("div",{className:"row justify-content-center"},u.a.createElement("div",{className:"col-sm-12"},u.a.createElement(oe,null)))),u.a.createElement(fe,null))}),Oe=function(e,t,a){null!=e&&(e.close(),a.onSetPeerConnection&&a.onSetPeerConnection({peerConnection:void 0})),null!=t&&(t.close(),a.onSetWebsocket&&a.onSetWebsocket({websocket:void 0})),a.onPlayStopped&&a.onPlayStopped()},Te=0,_e="[empty]",Ne=function(e){return{applicationName:e.applicationName,streamName:e.streamName,sessionId:_e}},Ce=function(e,t){console.log("peerConnectionOnError"),console.log(e),t.onError&&t.onError({message:"PeerConnection Error: "+e.message})},he=function(e,t,a,n,c){var r=JSON.parse(e.data),o=Number(r.status);if(514===o)++Te<10?setTimeout(ye(t,n),500):(Ie({message:"Live stream repeater timeout: "+t.streamName},c),Oe(a,n,c));else if(200!==o)Ie({message:r.statusDescription},c),Oe(a,n,c);else{var i=r.streamInfo;void 0!==i&&(_e=i.sessionId),null!=r.sdp&&(r.sdp.sdp=function(e){var t=e.split(/\r\n/),a="";for(var n in t){var c=t[n];if(0!==c.length){if(c.includes("profile-level-id")){var r=c.substr(c.indexOf("profile-level-id")+17,6),o=Number("0x"+r.substr(0,2)),i=Number("0x"+r.substr(2,2)),l=Number("0x"+r.substr(4,2));o>66&&(o=66,i=224,l=31),0===i&&(i=224);var s=("00"+o.toString(16)).slice(-2).toLowerCase()+("00"+i.toString(16)).slice(-2).toLowerCase()+("00"+l.toString(16)).slice(-2).toLowerCase();c=c.replace(r,s)}a+=c,a+="\r\n"}}return a}(r.sdp.sdp),console.log("SDP Data: "+r.sdp.sdp),a.setRemoteDescription(new RTCSessionDescription(r.sdp)).then((function(){return a.createAnswer().then((function(e){return function(e,t,a,n,c){n.setLocalDescription(e).then((function(){a.send('{"direction":"play", "command":"sendResponse", "streamInfo":'+JSON.stringify(Ne(t))+', "sdp":'+JSON.stringify(e)+', "userData":'+JSON.stringify({param1:"value1"})+"}")})).catch((function(e){var t=Object(g.a)({message:"Peer connection failed"},e);Ce(t,c)}))}(e,t,n,a,c)})).catch((function(e){return Ce(e,c)}))})).catch((function(e){return Ce(e,c)})));var l=r.iceCandidates;if(null!=l)for(var s in l)console.log("iceCandidates: "+JSON.stringify(l[s])),a.addIceCandidate(new RTCIceCandidate(l[s]))}},Ie=function(e,t){console.log("Websocket Error"),console.log(e),t.onError&&t.onError({message:"Websocket Error: "+e.message})},ye=function(e,t){t.send('{"direction":"play", "command":"getOffer", "streamInfo":'+JSON.stringify(Ne(e))+', "userData":'+JSON.stringify({param1:"value1"})+"}")},Ae=function(e,t,a){try{null==t&&(t=new WebSocket(e.signalingURL)),null!=t&&(Te=0,t.binaryType="arraybuffer",t.addEventListener("open",(function(){!function(e,t,a){var n;try{(n=new RTCPeerConnection).ontrack=function(e){a.onPeerConnectionOnTrack&&a.onPeerConnectionOnTrack(e)},n.onconnectionstatechange=function(e){"connected"===e.currentTarget.connectionState?a.onConnectionStateChange&&a.onConnectionStateChange({connected:!0}):a.onConnectionStateChange&&a.onConnectionStateChange({connected:!1})},t.addEventListener("message",(function(c){he(c,e,n,t,a)})),ye(e,t)}catch(c){Ie(c,a)}a.onSetPeerConnection&&a.onSetPeerConnection({peerConnection:n})}(e,t,a)})),t.addEventListener("error",(function(e){Ie(e,a)})),a.onSetWebsocket&&a.onSetWebsocket({websocket:t}))}catch(n){a.onError&&a.onError(n)}},Re=function(){var e=Object(s.useRef)(null),t=Object(v.b)(),a=Object(v.c)((function(e){return e.playSettings})),n=Object(v.c)((function(e){return e.webrtcPlay})),c=n.peerConnection,r=n.websocket,o=n.connected,i=n.audioTrack,l=n.videoTrack;return Object(s.useEffect)((function(){!a.playStart||a.playStarting||o||(t({type:"SET_PLAY_FLAGS",playStart:!1,playStarting:!0}),Ae(a,r,{onError:function(e){t({type:"SET_ERROR_MESSAGE",message:e.message})},onConnectionStateChange:function(e){t({type:"SET_WEBRTC_PLAY_CONNECTED",connected:e.connected})},onSetPeerConnection:function(e){t({type:"SET_WEBRTC_PLAY_PEERCONNECTION",peerConnection:e.peerConnection})},onSetWebsocket:function(e){t({type:"SET_WEBRTC_PLAY_WEBSOCKET",websocket:e.websocket})},onPeerConnectionOnTrack:function(e){null!=e.track&&null!=e.track.kind&&("audio"===e.track.kind?t({type:"SET_WEBRTC_PLAY_AUDIO_TRACK",audioTrack:e.track}):"video"===e.track.kind&&t({type:"SET_WEBRTC_PLAY_VIDEO_TRACK",videoTrack:e.track}))}})),a.playStarting&&o&&t({type:"SET_PLAY_FLAGS",playStarting:!1}),a.playStop&&!a.playStopping&&o&&(t({type:"SET_PLAY_FLAGS",playStop:!1,playStopping:!0}),Oe(c,r,{onSetPeerConnection:function(e){t({type:"SET_WEBRTC_PLAY_PEERCONNECTION",peerConnection:e.peerConnection})},onSetWebsocket:function(e){t({type:"SET_WEBRTC_PLAY_WEBSOCKET",websocket:e.websocket})},onPlayStopped:function(){t({type:"SET_WEBRTC_PLAY_CONNECTED",connected:!1})}})),a.playStopping&&!o&&t({type:"SET_PLAY_FLAGS",playStopping:!1})}),[t,e,a,c,r,o]),Object(s.useEffect)((function(){if(o){var t=new MediaStream;null!=i&&t.addTrack(i),null!=l&&t.addTrack(l),null!=e&&null!=e.current&&(e.current.srcObject=t)}else null!=e&&null!=e.current&&(e.current.srcObject=null)}),[i,l,o,e]),o?u.a.createElement("video",{id:"player-video",ref:e,autoPlay:!0,playsInline:!0,muted:!0,controls:!0}):null},we={signalingURL:"playSignalingURL",applicationName:"playApplicationName",streamName:"playStreamName"},ke=function(){var e=Object(v.b)(),t=Object(s.useState)(!1),a=Object(Y.a)(t,2),n=a[0],c=a[1],r=Object(v.c)((function(e){return e.playSettings})),o=Object(v.c)((function(e){return e.webrtcPlay}));return Object(s.useEffect)((function(){var t=Z("webrtcReactValues"),a=J.a.parse(window.location.search),n=Object(g.a)(Object(g.a)({},t),a);for(var r in we)if(null!=n[we[r]])switch(we[r]){case"playSignalingURL":e({type:"SET_PLAY_SIGNALING_URL",signalingURL:n[we[r]]});break;case"playApplicationName":e({type:"SET_PLAY_APPLICATION_NAME",applicationName:n[we[r]]});break;case"playStreamName":e({type:"SET_PLAY_STREAM_NAME",streamName:n[we[r]]})}c(!0)}),[e]),Object(s.useEffect)((function(){var e=Z("webrtcReactValues");for(var t in we)null!=r[t]&&(e[we[t]]=r[t]);X.a.set("webrtcReactValues",escape(JSON.stringify(e)))}),[r]),n?u.a.createElement("div",{className:"col-md-4 col-sm-12",id:"play-settings"},u.a.createElement("form",{id:"play-settings-form"},u.a.createElement("div",{className:"row"},u.a.createElement("div",{className:"col-12"},u.a.createElement("div",{className:"form-group"},u.a.createElement("label",{htmlFor:"playSdpURL"},"Signaling URL"),u.a.createElement("input",{type:"text",className:"form-control",id:"playSignalingURL",name:"playSignalingURL",maxLength:"1024",placeholder:"wss://[ssl-certificate-domain-name]/webrtc-session.json",value:r.signalingURL,onChange:function(t){return e({type:"SET_PLAY_SIGNALING_URL",signalingURL:t.target.value})}})))),u.a.createElement("div",{className:"row"},u.a.createElement("div",{className:"col-6"},u.a.createElement("div",{className:"form-group"},u.a.createElement("label",{htmlFor:"playApplicationName"},"Application Name"),u.a.createElement("input",{type:"text",className:"form-control",id:"playApplicationName",name:"playApplicationName",maxLength:"256",value:r.applicationName,onChange:function(t){return e({type:"SET_PLAY_APPLICATION_NAME",applicationName:t.target.value})}}))),u.a.createElement("div",{className:"col-6"},u.a.createElement("div",{className:"form-group"},u.a.createElement("label",{htmlFor:"playStreamName"},"Stream Name"),u.a.createElement("input",{type:"text",className:"form-control",id:"playStreamName",name:"playStreamName",maxLength:"256",value:r.streamName,onChange:function(t){return e({type:"SET_PLAY_STREAM_NAME",streamName:t.target.value})}})))),u.a.createElement("div",{className:"row"},u.a.createElement("div",{className:"col-10"},!o.connected&&u.a.createElement("button",{id:"play-toggle",type:"button",className:"btn",disabled:r.playStarting,onClick:function(t){return e({type:"SET_PLAY_FLAGS",playStart:!0})}},"Play"),o.connected&&u.a.createElement("button",{id:"play-toggle",type:"button",className:"btn",onClick:function(t){return e({type:"SET_PLAY_FLAGS",playStop:!0})}},"Stop"))))):null},Pe=function(){return u.a.createElement("div",{className:"container-fluid mt-3",id:"play-content"},u.a.createElement("div",{className:"row pr-3"},u.a.createElement("div",{className:"col-md-8 col-sm-12"},u.a.createElement("div",{id:"play-video-container"},u.a.createElement(Re,null))),u.a.createElement(ke,null)))},je=function(e){var t=Object(s.useRef)(null),a=Object(v.c)((function(e){return e.publishSettings})),n=Object(v.c)((function(e){return e.media})).stream,c=Object(s.useState)(),r=Object(Y.a)(c,2),o=(r[0],r[1]),i=Object(s.useState)(!1),l=Object(Y.a)(i,2),d=l[0],m=l[1],p=Object(s.useState)(),E=Object(Y.a)(p,2),S=E[0],b=E[1],f=Object(s.useState)(),g=Object(Y.a)(f,2),O=g[0],T=g[1],_=Object(s.useState)(e.streamName===a.streamName?"PUBLISH_PLAYER":"PEER_PLAYER"),N=Object(Y.a)(_,2),C=N[0],h=(N[1],!0);return Object(s.useEffect)((function(){if(h)if("PUBLISH_PLAYER"===C)console.log("publish player"),null!=n&&null!=t.current&&(t.current.muted=!0,t.current.srcObject=n);else{console.log("peer player");var c={signalingURL:a.signalingURL,applicationName:a.applicationName,streamName:e.streamName};Ae(c,null,{onPeerConnectionOnTrack:function(e){console.log("getting peer tracks"),null!=e.track&&null!=e.track.kind&&("audio"===e.track.kind?b(e.track):"video"===e.track.kind&&T(e.track))},onConnectionStateChange:function(e){console.log("connected state"),console.log(e),h&&m(e.connected)},onError:function(e){console.log(e)},onSetPeerConnection:function(e){o(e.peerConnection)}})}return function(){return h=!1}}),[t]),Object(s.useEffect)((function(){if("PEER_PLAYER"===C&&d&&h)if(d){var e=new MediaStream;null!=S&&e.addTrack(S),null!=O&&e.addTrack(O),null!=t&&null!=t.current&&(t.current.srcObject=e)}else null!=t&&null!=t.current&&(t.current.srcObject=null);return function(){return h=!1}}),[d]),u.a.createElement("video",{id:e.streamName,className:"meeting-peer-player",ref:t,autoPlay:!0,playsInline:!0})},Le=function(){var e=Object(v.b)(),t=Object(v.c)((function(e){return e.publishSettings})),a=Object(v.c)((function(e){return e.webrtcMeeting})),n=Object(s.useRef)(a.peerStreams),c=Object(s.useState)(),r=Object(Y.a)(c,2),o=r[0],i=r[1];return Object(s.useEffect)((function(){n.current=a.peerStreams,!t.publishStart||t.publishStarting||a.connected||(e({type:"SET_PUBLISH_FLAGS",publishStart:!1,publishStarting:!0}),Se(t,a.websocket,{onError:function(t){e({type:"SET_ERROR_MESSAGE",message:t.message})},onConnectionStateChange:function(t){e({type:"SET_WEBRTC_MEETING_CONNECTED",connected:t.connected})},onSetPeerConnection:function(t){e({type:"SET_WEBRTC_MEETING_PEERCONNECTION",peerConnection:t.peerConnection})},onSetWebsocket:function(t){e({type:"SET_WEBRTC_MEETING_WEBSOCKET",websocket:t.websocket})},onSetSenders:function(t){e({type:"SET_WEBRTC_MEETING_PEERCONNECTION_AUDIO_SENDER",peerConnectionAudioSender:t.audioSender}),e({type:"SET_WEBRTC_MEETING_PEERCONNECTION_VIDEO_SENDER",peerConnectionVideoSender:t.videoSender})}})),t.publishStarting&&a.connected&&(e({type:"SET_PUBLISH_FLAGS",publishStarting:!1}),e({type:"ADD_PEER_VIDEO_PLAYER",peerStream:{streamName:t.streamName}}),a.websocket&&(a.websocket.addEventListener("message",(function(a){var c=JSON.parse(a.data),r=c.command;if(0==="getAvailableStreams".localeCompare(r)&&null!==c.availableStreams){var o=c.availableStreams.filter((function(e){return!(e.streamName.includes(t.streamName)&&e.streamName.includes("_"))}));o=o.filter((function(e){return!(e.streamName===t.streamName)}));for(var i=0;i<o.length;i++)L(n.current,o[i].streamName).then((function(t){e(t)}));for(var l=0;l<n.current.length;l++)n.current[l].streamName!==t.streamName&&D(o,n.current[l].streamName).then((function(t){e(t)}))}})),i(setInterval((function(){if(a.websocket){var e={applicationName:t.applicationName,streamName:t.streamName,sessionId:"[empty]"};a.websocket.send('{"direction":"publish", "command":"getAvailableStreams", "streamInfo":'+JSON.stringify(e)+"}")}}),3e3)))),t.publishStop&&!t.publishStopping&&a.connected&&(clearInterval(o),e({type:"SET_PUBLISH_FLAGS",publishStop:!1,publishStopping:!0}),e({type:"REMOVE_ALL_PLAYERS"}),be(a.peerConnection,a.websocket,{onSetPeerConnection:function(t){e({type:"SET_WEBRTC_MEETING_PEERCONNECTION",peerConnection:t.peerConnection})},onSetWebsocket:function(t){e({type:"SET_WEBRTC_MEETING_WEBSOCKET",websocket:t.websocket})},onPublishStopped:function(){e({type:"SET_WEBRTC_MEETING_CONNECTED",connected:!1})}})),t.publishStopping&&!a.connected&&e({type:"SET_PUBLISH_FLAGS",publishStopping:!1})}),[e,t,a]),u.a.createElement("div",{id:"player-list"},a.peerStreams.map((function(e,t){return u.a.createElement(je,{streamName:e.streamName,key:t})})))},De=a(34),Me=a.n(De),Be=a(35),Ue=a.n(Be),xe=a(36),Ve=a.n(xe),We=a(37),Ge=a.n(We),He=function(){var e=Object(v.b)(),t=Object(v.c)((function(e){return e.publishSettings})),a=Object(v.c)((function(e){return e.webrtcMeeting})),n=Object(v.c)((function(e){return e.media})),c=n.cameras,r=n.microphones,o=Object(v.c)((function(e){return e.media})).stream,i=Object(v.c)((function(e){return e.media})),l=i.videoTracksMap,d=i.displayScreenTrack,m=i.audioTracksMap,p=Object(v.c)((function(e){return e.publishSettings})),E=p.videoTrack1DeviceId,S=p.audioTrackDeviceId,b=Object(s.useState)(!1),f=Object(Y.a)(b,2),O=f[0],T=f[1];return Object(s.useEffect)((function(){var t=Z("webrtcReactValues"),a=J.a.parse(window.location.search),n=Object(g.a)(Object(g.a)({},t),a);for(var c in n)switch(c){case"meeting.signalingURL":e({type:"SET_PUBLISH_SIGNALING_URL",signalingURL:n[c]});break;case"meeting.applicationName":e({type:"SET_PUBLISH_APPLICATION_NAME",applicationName:n[c]})}T(!0)}),[e]),Object(s.useEffect)((function(){var t=new MediaStream,a=void 0;if("screen"===E&&null!=d?(t.addTrack(d),a=d):""!==E&&"screen"!==E&&null!=l[E]&&(t.addTrack(l[E]),a=l[E]),null!=o){var n=o.getAudioTracks();n.length>0&&t.addTrack(n[0])}e({type:"SET_MEDIA_STREAM",stream:t}),e({type:"SET_PUBLISH_VIDEO_TRACK",videoTrack:a})}),[e,l,d,E]),Object(s.useEffect)((function(){var t=new MediaStream,a=void 0;if(""!==S&&null!=m[S]&&(t.addTrack(m[S]),a=m[S]),null!=o){var n=o.getVideoTracks();n.length>0&&t.addTrack(n[0])}e({type:"SET_MEDIA_STREAM",stream:t}),e({type:"SET_PUBLISH_AUDIO_TRACK",audioTrack:a})}),[e,m,S]),O?u.a.createElement("div",{className:"col-md-4 col-sm-12",id:"meeting-settings"},u.a.createElement("form",{id:"meeting-settings-form"},u.a.createElement("div",{className:"row"},u.a.createElement("div",{className:"col-12"},u.a.createElement("div",{className:"form-group"},u.a.createElement("label",{htmlFor:"signalingURL"},"Signaling URL"),u.a.createElement("input",{type:"text",className:"form-control",id:"signalingURL",name:"signalingURL",maxLength:"1024",placeholder:"wss://[ssl-certificate-domain-name]/webrtc-session.json",value:t.signalingURL,onChange:function(t){return e({type:"SET_PUBLISH_SIGNALING_URL",signalingURL:t.target.value})}})))),u.a.createElement("div",{className:"row"},u.a.createElement("div",{className:"col-6"},u.a.createElement("div",{className:"form-group"},u.a.createElement("label",{htmlFor:"applicationName"},"Application Name"),u.a.createElement("input",{type:"text",className:"form-control",id:"applicationName",name:"applicationName",maxLength:"256",value:t.applicationName,onChange:function(t){return e({type:"SET_PUBLISH_APPLICATION_NAME",applicationName:t.target.value})}}))),u.a.createElement("div",{className:"col-6"},u.a.createElement("div",{className:"form-group"},u.a.createElement("label",{htmlFor:"meetingStreamName"},"Stream Name"),u.a.createElement("input",{type:"text",className:"form-control",id:"meetingStreamName",name:"meetingStreamName",maxLength:"256",value:t.streamName,onChange:function(t){return e({type:"SET_PUBLISH_STREAM_NAME",streamName:t.target.value})}})))),u.a.createElement("div",{className:"row"},u.a.createElement("div",{className:"col-10"},u.a.createElement("div",{className:"form-group"},u.a.createElement("label",{htmlFor:"camera-list-select"},"Input Camera"),u.a.createElement("select",{id:"camera-list-select",className:"form-control",value:t.videoTrack1DeviceId,onChange:function(t){return e({type:"SET_PUBLISH_VIDEO_TRACK1_DEVICEID",videoTrack1DeviceId:t.target.value})}},u.a.createElement("option",{value:""},"None"),c.map((function(e,t){return u.a.createElement("option",{key:t,value:e.deviceId},e.label)}))))),u.a.createElement("div",{className:"col-2"},u.a.createElement("button",{id:"camera-toggle",type:"button",className:"control-button",onClick:function(){return e({type:"TOGGLE_VIDEO_ENABLED"})}},u.a.createElement("img",{alt:"",className:"noll",id:"video-off",src:Ve.a,style:{display:t.videoTrack&&t.videoTrack.enabled?"inline":"none"}}),u.a.createElement("img",{alt:"",className:"noll",id:"video-on",src:Ge.a,style:{display:t.videoTrack&&t.videoTrack.enabled?"none":"inline"}})))),u.a.createElement("div",{className:"row"},u.a.createElement("div",{className:"col-10"},u.a.createElement("div",{className:"form-group"},u.a.createElement("label",{htmlFor:"mic-list-select"},"Input Microphone"),u.a.createElement("select",{id:"mic-list-select",className:"form-control",value:t.audioTrackDeviceId,onChange:function(t){return e({type:"SET_PUBLISH_AUDIO_TRACK_DEVICEID",audioTrackDeviceId:t.target.value})}},u.a.createElement("option",{value:""},"None"),r.map((function(e,t){return u.a.createElement("option",{key:t,value:e.deviceId},e.label)}))))),u.a.createElement("div",{className:"col-2"},u.a.createElement("button",{id:"mute-toggle",type:"button",className:"control-button",onClick:function(t){return e({type:"TOGGLE_AUDIO_ENABLED"})}},u.a.createElement("img",{alt:"",className:"noll",id:"mute-off",src:Me.a,style:{display:t.audioTrack&&t.audioTrack.enabled?"inline":"none"}}),u.a.createElement("img",{alt:"",className:"noll",id:"mute-on",src:Ue.a,style:{display:t.audioTrack&&t.audioTrack.enabled?"none":"inline"}})))),u.a.createElement("div",{className:"row"},u.a.createElement("div",{className:"col-10"},!a.connected&&u.a.createElement("button",{id:"meeting-toggle",type:"button",className:"btn",disabled:t.publishStarting,onClick:function(t){return e({type:"SET_PUBLISH_FLAGS",publishStart:!0})}},"Join"),a.connected&&u.a.createElement("button",{id:"meeting-toggle",type:"button",className:"btn",onClick:function(t){return e({type:"SET_PUBLISH_FLAGS",publishStop:!0})}},"Leave")),u.a.createElement("div",{className:"col-2"},u.a.createElement(re,{settings:t,parameters:["signalingURL","applicationName"],prefix:"meeting."}))))):null},Fe=function(){return u.a.createElement("div",{className:"row justify-content-center"},u.a.createElement("div",{className:"col-md-8 col-sm-12"},u.a.createElement("div",{id:"peer-video-container"},u.a.createElement(Le,null))),u.a.createElement(He,null))},Ye=a(9),Ke=a.n(Ye),Je=a(13),ze=function(e){return new Promise((function(t,a){navigator.mediaDevices.getUserMedia?navigator.mediaDevices.getUserMedia(e).then((function(e){t(e)})).catch((function(e){a(e)})):navigator.getUserMedia?navigator.getUserMedia(e,(function(e){t(e)}),(function(e){a(e)})):a({message:"Your browser does not support WebRTC"})}))},qe=function(){return new Promise((function(e,t){function a(t){e(t)}var n={video:!0};navigator.getDisplayMedia?navigator.getDisplayMedia(n).then((function(e){a(e)})).catch((function(e){t(e)})):navigator.mediaDevices.getDisplayMedia?navigator.mediaDevices.getDisplayMedia(n).then((function(e){a(e)})).catch((function(e){t(e)})):(n={video:{mediaSource:"screen"}},navigator.mediaDevices.getUserMedia(n).then((function(e){a(e)})).catch((function(e){t(e)})))}))},Xe=function(){var e=Object(Je.a)(Ke.a.mark((function e(t){var a;return Ke.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=!1,e.prev=1,e.next=4,ze({video:T.default,audio:!0});case 4:a=!0,e.next=9;break;case 7:e.prev=7,e.t0=e.catch(1);case 9:t({type:"SET_MEDIA_GOT_PERMISSIONS",gotPermissions:a});case 10:case"end":return e.stop()}}),e,null,[[1,7]])})));return function(t){return e.apply(this,arguments)}}(),Ze=function(){var e=Object(Je.a)(Ke.a.mark((function e(t,a,n){var c,r,o,i,l;return Ke.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:c=Object(g.a)({},n),r=0;case 2:if(!(r<a.length)){e.next=18;break}return(o={video:T.default,audio:!1}).video.deviceId=a[r].deviceId,e.prev=5,e.next=8,ze(o);case 8:i=e.sent,(l=i.getVideoTracks()).length>0&&(c[a[r].deviceId]=l[0]),e.next=15;break;case 13:e.prev=13,e.t0=e.catch(5);case 15:r++,e.next=2;break;case 18:t({type:"SET_MEDIA_TRACKS",videoTracksMap:c});case 19:case"end":return e.stop()}}),e,null,[[5,13]])})));return function(t,a,n){return e.apply(this,arguments)}}(),$e=function(e){console.log("onScreenShareEnded"),e({type:"SET_PUBLISH_VIDEO_TRACK1_DEVICEID",videoTrack1DeviceId:"none"}),e({type:"SET_MEDIA_SCREEN_SHARE_ENDED"})},Qe=function(){var e=Object(Je.a)(Ke.a.mark((function e(t){return Ke.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:qe().then((function(e){var a=e.getVideoTracks()[0];a.onended=function(){$e(t)},t({type:"SET_MEDIA_TRACKS",displayScreenTrack:a})})).catch((function(e){}));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),et=function(){var e=Object(Je.a)(Ke.a.mark((function e(t,a,n){var c,r,o,i,l;return Ke.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:c=Object(g.a)({},n),r=0;case 2:if(!(r<a.length)){e.next=18;break}return(o={audio:{}}).audio.deviceId=a[r].deviceId,e.prev=5,e.next=8,ze(o);case 8:i=e.sent,(l=i.getAudioTracks()).length>0&&(c[a[r].deviceId]=l[0]),e.next=15;break;case 13:e.prev=13,e.t0=e.catch(5);case 15:r++,e.next=2;break;case 18:t({type:"SET_MEDIA_TRACKS",audioTracksMap:c});case 19:case"end":return e.stop()}}),e,null,[[5,13]])})));return function(t,a,n){return e.apply(this,arguments)}}(),tt=function(){var e=Object(v.b)(),t=Object(v.c)((function(e){return e.media})),a=t.gotPermissions,n=t.cameras,c=t.microphones,r=t.videoTracksMap,o=t.audioTracksMap,i=t.displayScreenTrack,l=Object(v.c)((function(e){return e.publishSettings})).videoTrack1DeviceId,d=Object(v.c)((function(e){return e.compositeSettings})).videoTrack1DeviceId,m=Object(s.useRef)(r),p=Object(s.useRef)(o);return Object(s.useEffect)((function(){Xe(e)}),[e]),Object(s.useEffect)((function(){a&&Ze(e,n,m.current)}),[e,a,n]),Object(s.useEffect)((function(){a&&et(e,c,p.current)}),[e,a,c]),Object(s.useEffect)((function(){"screen"===l&&null==i&&Qe(e)}),[e,l,i]),Object(s.useEffect)((function(){"screen"===d&&null==i&&Qe(e)}),[e,d,i]),u.a.createElement(u.a.Fragment,null)},at={loadingUserMedia:"Error loading user media",loadingUserDevices:"Error loading cameras and microphones"},nt=function(){return new Promise((function(e,t){navigator.mediaDevices.enumerateDevices().then((function(t){for(var a={cameras:[],microphones:[]},n=0;n<t.length;n++)"videoinput"===t[n].kind?a.cameras.push(t[n]):"audioinput"===t[n].kind&&a.microphones.push(t[n]);e(a)})).catch((function(e){t(e)}))}))},ct=function(){var e=Object(Je.a)(Ke.a.mark((function e(t){var a,n,c;return Ke.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t({type:"SET_MEDIA_DEVICES_STATE",devicesLoading:!0}),e.prev=1,e.next=4,nt();case 4:a=e.sent,n=a.cameras,c=a.microphones,t({type:"SET_MEDIA_CAMERAS",cameras:n}),t({type:"SET_MEDIA_MICROPHONES",microphones:c}),t({type:"SET_MEDIA_DEVICES_STATE",devicesLoading:!1,devicesLoaded:!0}),n.length>0&&t({type:"SET_PUBLISH_VIDEO_TRACK1_DEVICEID",videoTrack1DeviceId:n[0].deviceId}),c.length>0&&t({type:"SET_PUBLISH_AUDIO_TRACK_DEVICEID",audioTrackDeviceId:c[0].deviceId}),e.next=18;break;case 14:e.prev=14,e.t0=e.catch(1),console.log(e.t0),t({type:"SET_ERROR_MESSAGE",message:at.loadingUserDevices+": "+e.t0.message});case 18:case"end":return e.stop()}}),e,null,[[1,14]])})));return function(t){return e.apply(this,arguments)}}(),rt=function(){var e=Object(v.b)(),t=Object(v.c)((function(e){return e.media})).gotPermissions;return Object(s.useEffect)((function(){t&&ct(e)}),[e,t]),u.a.createElement(u.a.Fragment,null)},ot=(a(64),a(65),function(){return u.a.createElement(v.a,{store:x},u.a.createElement(tt,null),u.a.createElement(rt,null),u.a.createElement(p.a,{basename:Object({NODE_ENV:"production",PUBLIC_URL:".",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0}).REACT_APP_BASENAME},u.a.createElement("div",{className:"container-fluid"},u.a.createElement(G,null),u.a.createElement(H,null)),u.a.createElement(E.c,null,u.a.createElement(E.a,{path:"/play"},u.a.createElement(Pe,null)),u.a.createElement(E.a,{path:"/meeting"},u.a.createElement(Fe,null)),u.a.createElement(E.a,{path:"/composite"},u.a.createElement(ge,null)),u.a.createElement(E.a,{path:"/"},u.a.createElement(ge,null)))))});Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));m.a.render(u.a.createElement(u.a.StrictMode,null,u.a.createElement(ot,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[39,1,2]]]);
//# sourceMappingURL=main.29f73084.chunk.js.map